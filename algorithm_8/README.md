# SVD Refinement — Algorithm 8 Implementation

## Структура проекта

```
algorithm_8/
├── refineSDV8_original.hpp            
# Оригинальный шаблонный вариант класса Ogita_Aishima_SVD
├── refineSVD8_dynamic.hpp     
#  Динамическая реализация алгоритма 8
└── tests/
    ├── test_alg8.cpp          
    # Массовое тестирование разных размеров/шумов/итераций
    ├── test_alg8_special.cpp  
    # Отладочный частный случай с выводом матриц
    ├── alg8_test_results.csv  
    # [output] CSV-файл с результатами `test_alg8`
    └── alg8_special_output.txt
    # [output] Распечатка всех матриц из `test_alg8_special`
```

## Реализация

### `refineSVD8_dynamic.hpp`
- Содержит реализацию **алгоритма 8** с поддержкой `Matrix<T, Dynamic, Dynamic>`.
- Используется смешанная точность (`cast<double>()`) для устойчивости.
- Поддерживает прямоугольные матрицы с `m ≥ n`.

Функция:
```cpp
void refineSVD8(const Mat& A, Mat& U, Mat& V, Mat& S);
```

Она принимает:
- `A` — исходную матрицу,
- `U`, `V` — зашумлённые ортогональные приближения,
- `S` — сингулярные значения.

### `test_alg8.cpp`
- Автоматическое тестирование множества размеров (`m × n`), интервалов для сингулярных значений, уровней шума и числа итераций.
- Результаты сохраняются в `alg8_test_results.csv`:
  - ошибки восстановления,
  - ошибки по `U`, `V`, `S`,
  - время исполнения.

### `test_alg8_special.cpp`
- Проверка одного частного случая (`5×3`) с фиксированными сингулярными значениями.
- Результаты (все матрицы до и после уточнения) сохраняются в `alg8_special_output.txt`.


## Зависимости
- [Eigen 3](https://eigen.tuxfamily.org/) — библиотека линейной алгебры.

**ВАЖНО** -  верно подключить библиотеку Eigen в зависимости от среды выполнения и типа установки. В случае для macOS: `#include <eigen3/Eigen/Dense>`


